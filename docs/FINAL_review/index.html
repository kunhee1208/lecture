<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kunhee Lee">

<title>SKKU BIOHRS-FINAL Review</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SKKU BIOHRS-FINAL Review</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kunhee Lee </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="r코드와-실행결과를-모두-아래-메일로-보내주세요." class="level2">
<h2 class="anchored" data-anchor-id="r코드와-실행결과를-모두-아래-메일로-보내주세요.">R코드와 실행결과를 모두 아래 메일로 보내주세요.</h2>
<ul>
<li>lisalee1208@naver.com</li>
<li>jinseob2kim@gmail.com</li>
</ul>
</section>
<section id="필요한-library-및-데이터-불러오기" class="level2">
<h2 class="anchored" data-anchor-id="필요한-library-및-데이터-불러오기">필요한 library 및 데이터 불러오기</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tableone);<span class="fu">library</span>(data.table);<span class="fu">library</span>(magrittr);<span class="fu">library</span>(survival);<span class="fu">library</span>(jstable)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/jinseob2kim/lecture-snuhlab/master/data/example_g1e.csv"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">fread</span>(url, <span class="at">header=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dt의 1~6행 살펴보기</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EXMD_BZ_YYYY RN_INDI HME_YYYYMM Q_PHX_DX_STK Q_PHX_DX_HTDZ Q_PHX_DX_HTN
1:         2009  562083     200909            0             0            1
2:         2009  334536     200911            0             0            0
3:         2009  911867     200903            0             0            0
4:         2009  183321     200908           NA            NA           NA
5:         2009  942671     200909           NA            NA           NA
6:         2009  979358     200912           NA            NA           NA
   Q_PHX_DX_DM Q_PHX_DX_DLD Q_PHX_DX_PTB Q_HBV_AG Q_SMK_YN Q_DRK_FRQ_V09N HGHT
1:           0            0           NA        3        1              0  144
2:           0            0           NA        2        1              0  162
3:           0            0           NA        3        1              0  163
4:          NA           NA           NA        3        1              0  152
5:          NA           NA           NA        3        1              0  159
6:          NA           NA           NA        2        1              0  157
   WGHT WSTC  BMI VA_LT VA_RT BP_SYS BP_DIA URN_PROT  HGB FBS TOT_CHOL  TG HDL
1:   61   90 29.4   0.7   0.8    120     80        1 12.6 117      264 128  60
2:   51   63 19.4   0.8   1.0    120     80        1 13.8  96      169  92  70
3:   65   82 24.5   0.7   0.6    130     80        1 15.0 118      216 132  55
4:   51   70 22.1   0.8   0.9    101     62        1 13.1  90      199 100  65
5:   50   73 19.8   0.7   0.8    132     78        1 13.0  92      162  58  40
6:   55   73 22.3   1.5   1.5    110     70        1 11.9 100      192 109  53
   LDL CRTN SGOT SGPT GGT GFR
1: 179  0.9   25   20  25  59
2:  80  0.9   18   15  28  74
3: 134  0.8   26   30  30  79
4: 114  0.9   18   14  11  61
5: 111  0.9   24   23  15  49
6: 117  0.7   15   12  14  83</code></pre>
</div>
</div>
</section>
<section id="q1.-table-1-만들기15점" class="level2">
<h2 class="anchored" data-anchor-id="q1.-table-1-만들기15점">Q1. Table 1 만들기(15점)</h2>
<p>데이터(dt)의 연도 별 주어진 변수의 기술통계량을 Table로 나타내어라. 단, 변수 Q_SMK_YN과 Q_HBV_AG는 범주형으로.</p>
<p>주어진 변수 : “HGHT”, “WGHT”, “BMI”, “HDL”, “LDL”, “Q_SMK_YN”, “Q_HBV_AG” (총 7개)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># myVars : 주어진 변수 추출</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>myVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"HGHT"</span>,<span class="st">"WGHT"</span>,<span class="st">"BMI"</span>,<span class="st">"HDL"</span>,<span class="st">"LDL"</span>, <span class="st">"Q_SMK_YN"</span>,<span class="st">"Q_HBV_AG"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># catVars : 주어진 변수 중 범주형 변수(categorical variables) 추출</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>catVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Q_SMK_YN"</span>,<span class="st">"Q_HBV_AG"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 첫 번째 방법 : 범주형으로 미리 변환하지 않고 'factorVars'로 지정</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">CreateTableOne</span>(<span class="at">vars=</span> myVars, <span class="at">factorVars =</span> catVars, <span class="at">strata=</span> <span class="st">"EXMD_BZ_YYYY"</span>, <span class="at">data=</span> dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Stratified by EXMD_BZ_YYYY
                   2009            2010           2011           2012          
  n                   214             236            223            234        
  HGHT (mean (SD)) 164.08 (9.13)   164.93 (8.73)  164.15 (9.58)  164.92 (9.20) 
  WGHT (mean (SD))  64.33 (12.50)   65.14 (12.24)  64.90 (12.84)  65.82 (12.41)
  BMI (mean (SD))   23.76 (3.39)    23.83 (3.27)   23.96 (3.46)   24.09 (3.34) 
  HDL (mean (SD))   55.61 (15.26)   55.16 (13.96)  57.31 (38.67)  55.95 (13.49)
  LDL (mean (SD))  150.95 (547.09) 112.99 (35.67) 112.94 (33.56) 117.53 (33.05)
  Q_SMK_YN (%)                                                                 
     1                125 (59.0)      132 (55.9)     140 (62.8)     146 (62.4) 
     2                 34 (16.0)       42 (17.8)      35 (15.7)      36 (15.4) 
     3                 53 (25.0)       62 (26.3)      48 (21.5)      52 (22.2) 
  Q_HBV_AG (%)                                                                 
     1                 14 ( 6.6)        6 ( 2.5)      12 ( 5.4)      12 ( 5.1) 
     2                129 (60.8)      147 (62.3)     147 (65.9)     160 (68.4) 
     3                 69 (32.5)       83 (35.2)      64 (28.7)      62 (26.5) 
                  Stratified by EXMD_BZ_YYYY
                   2013           2014           2015           p      test
  n                   243            254            240                    
  HGHT (mean (SD)) 164.91 (8.87)  164.32 (9.37)  164.48 (9.47)   0.890     
  WGHT (mean (SD))  64.91 (12.27)  64.47 (12.13)  66.08 (13.36)  0.705     
  BMI (mean (SD))   23.75 (3.33)   23.78 (3.32)   24.28 (3.54)   0.541     
  HDL (mean (SD))   55.46 (14.61)  55.64 (13.66)  56.27 (14.96)  0.935     
  LDL (mean (SD))  111.16 (32.33) 116.55 (65.55) 111.53 (31.83)  0.371     
  Q_SMK_YN (%)                                                   0.856     
     1                141 (58.0)     157 (61.8)     154 (64.2)             
     2                 35 (14.4)      38 (15.0)      36 (15.0)             
     3                 67 (27.6)      59 (23.2)      50 (20.8)             
  Q_HBV_AG (%)                                                   0.073     
     1                 10 ( 4.1)       9 ( 3.5)      14 ( 5.8)             
     2                168 (69.1)     189 (74.4)     162 (67.5)             
     3                 65 (26.7)      56 (22.0)      64 (26.7)             </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 두 번째 방법 : 범주형으로 미리 변환 후 'vars'에 주어진 모든 변수 지정 </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># catVars 범주형으로 변환</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>dt[, (catVars) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, factor), .SDcols<span class="ot">=</span> catVars]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">CreateTableOne</span>(<span class="at">vars=</span> myVars, <span class="at">strata=</span> <span class="st">"EXMD_BZ_YYYY"</span>, <span class="at">data=</span> dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Stratified by EXMD_BZ_YYYY
                   2009            2010           2011           2012          
  n                   214             236            223            234        
  HGHT (mean (SD)) 164.08 (9.13)   164.93 (8.73)  164.15 (9.58)  164.92 (9.20) 
  WGHT (mean (SD))  64.33 (12.50)   65.14 (12.24)  64.90 (12.84)  65.82 (12.41)
  BMI (mean (SD))   23.76 (3.39)    23.83 (3.27)   23.96 (3.46)   24.09 (3.34) 
  HDL (mean (SD))   55.61 (15.26)   55.16 (13.96)  57.31 (38.67)  55.95 (13.49)
  LDL (mean (SD))  150.95 (547.09) 112.99 (35.67) 112.94 (33.56) 117.53 (33.05)
  Q_SMK_YN (%)                                                                 
     1                125 (59.0)      132 (55.9)     140 (62.8)     146 (62.4) 
     2                 34 (16.0)       42 (17.8)      35 (15.7)      36 (15.4) 
     3                 53 (25.0)       62 (26.3)      48 (21.5)      52 (22.2) 
  Q_HBV_AG (%)                                                                 
     1                 14 ( 6.6)        6 ( 2.5)      12 ( 5.4)      12 ( 5.1) 
     2                129 (60.8)      147 (62.3)     147 (65.9)     160 (68.4) 
     3                 69 (32.5)       83 (35.2)      64 (28.7)      62 (26.5) 
                  Stratified by EXMD_BZ_YYYY
                   2013           2014           2015           p      test
  n                   243            254            240                    
  HGHT (mean (SD)) 164.91 (8.87)  164.32 (9.37)  164.48 (9.47)   0.890     
  WGHT (mean (SD))  64.91 (12.27)  64.47 (12.13)  66.08 (13.36)  0.705     
  BMI (mean (SD))   23.75 (3.33)   23.78 (3.32)   24.28 (3.54)   0.541     
  HDL (mean (SD))   55.46 (14.61)  55.64 (13.66)  56.27 (14.96)  0.935     
  LDL (mean (SD))  111.16 (32.33) 116.55 (65.55) 111.53 (31.83)  0.371     
  Q_SMK_YN (%)                                                   0.856     
     1                141 (58.0)     157 (61.8)     154 (64.2)             
     2                 35 (14.4)      38 (15.0)      36 (15.0)             
     3                 67 (27.6)      59 (23.2)      50 (20.8)             
  Q_HBV_AG (%)                                                   0.073     
     1                 10 ( 4.1)       9 ( 3.5)      14 ( 5.8)             
     2                168 (69.1)     189 (74.4)     162 (67.5)             
     3                 65 (26.7)      56 (22.0)      64 (26.7)             </code></pre>
</div>
</div>
</section>
<section id="q2.-선형회귀-로지스틱-콕스생존분석-table-만들기15점" class="level2">
<h2 class="anchored" data-anchor-id="q2.-선형회귀-로지스틱-콕스생존분석-table-만들기15점">Q2. 선형회귀, 로지스틱, 콕스생존분석 Table 만들기(15점)</h2>
<section id="선형-회귀분석linear-regression5점" class="level3">
<h3 class="anchored" data-anchor-id="선형-회귀분석linear-regression5점">2-1. 선형 회귀분석(Linear regression)(5점)</h3>
<ul>
<li>survival 패키지에 내장되어 있는 대장암 데이터 ‘colon’ 사용</li>
<li>time ~ rx + age + sex 선형회귀 실행 후 table로 나타내어라.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colon의 1~6행 살펴보기</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(colon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id study      rx sex age obstruct perfor adhere nodes status differ extent
1  1     1 Lev+5FU   1  43        0      0      0     5      1      2      3
2  1     1 Lev+5FU   1  43        0      0      0     5      1      2      3
3  2     1 Lev+5FU   1  63        0      0      0     1      0      2      3
4  2     1 Lev+5FU   1  63        0      0      0     1      0      2      3
5  3     1     Obs   0  71        0      0      1     7      1      2      2
6  3     1     Obs   0  71        0      0      1     7      1      2      2
  surg node4 time etype
1    0     1 1521     2
2    0     1  968     1
3    0     0 3087     2
4    0     0 3087     1
5    0     1  963     2
6    0     1  542     1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>res.reg <span class="ot">&lt;-</span> <span class="fu">glm</span>(time <span class="sc">~</span> rx <span class="sc">+</span> age <span class="sc">+</span> sex, <span class="at">data =</span> colon)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>tb.reg <span class="ot">&lt;-</span> <span class="fu">glmshow.display</span>(res.reg)     <span class="co"># 'jstable 패키지의 glmshow.display' 이용</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tb.reg<span class="sc">$</span>table, <span class="at">caption =</span> tb.reg<span class="sc">$</span>first.line)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Linear regression predicting time</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 27%">
<col style="width: 16%">
<col style="width: 25%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">crude coeff.(95%CI)</th>
<th style="text-align: left;">crude P value</th>
<th style="text-align: left;">adj. coeff.(95%CI)</th>
<th style="text-align: left;">adj. P value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rx: ref.=Obs</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lev</td>
<td style="text-align: left;">24.66 (-79.49,128.82)</td>
<td style="text-align: left;">0.643</td>
<td style="text-align: left;">22.98 (-81.3,127.27)</td>
<td style="text-align: left;">0.666</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lev+5FU</td>
<td style="text-align: left;">271.07 (166.41,375.74)</td>
<td style="text-align: left;">&lt; 0.001</td>
<td style="text-align: left;">273.05 (168.19,377.9)</td>
<td style="text-align: left;">&lt; 0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">0.38 (-3.22,3.99)</td>
<td style="text-align: left;">0.835</td>
<td style="text-align: left;">0.37 (-3.21,3.95)</td>
<td style="text-align: left;">0.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">13.93 (-72.26,100.12)</td>
<td style="text-align: left;">0.751</td>
<td style="text-align: left;">32.67 (-53.21,118.55)</td>
<td style="text-align: left;">0.456</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="로지스틱-회귀분석logistic-regression5점" class="level3">
<h3 class="anchored" data-anchor-id="로지스틱-회귀분석logistic-regression5점">2-2. 로지스틱 회귀분석(Logistic regression)(5점)</h3>
<ul>
<li>마찬가지로 대장암 데이터 ‘colon’ 사용</li>
<li>status ~ rx + age + sex 로지스틱 회귀 실행 후 table로 나타내어라.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>res.logistic <span class="ot">&lt;-</span> <span class="fu">glm</span>(status <span class="sc">~</span> rx <span class="sc">+</span> age <span class="sc">+</span> sex, <span class="at">data =</span> colon, <span class="at">family =</span> binomial)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tb.logistic <span class="ot">&lt;-</span> <span class="fu">glmshow.display</span>(res.logistic)   <span class="co"># 'jstable 패키지의 glmshow.display' 이용</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tb.logistic<span class="sc">$</span>table, <span class="at">caption =</span> tb.logistic<span class="sc">$</span>first.line)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Logistic regression predicting status</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 22%">
<col style="width: 18%">
<col style="width: 22%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">crude OR.(95%CI)</th>
<th style="text-align: left;">crude P value</th>
<th style="text-align: left;">adj. OR.(95%CI)</th>
<th style="text-align: left;">adj. P value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rx: ref.=Obs</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lev</td>
<td style="text-align: left;">0.96 (0.77,1.2)</td>
<td style="text-align: left;">0.709</td>
<td style="text-align: left;">0.96 (0.77,1.2)</td>
<td style="text-align: left;">0.747</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lev+5FU</td>
<td style="text-align: left;">0.55 (0.44,0.68)</td>
<td style="text-align: left;">&lt; 0.001</td>
<td style="text-align: left;">0.54 (0.43,0.68)</td>
<td style="text-align: left;">&lt; 0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">1 (0.99,1)</td>
<td style="text-align: left;">0.296</td>
<td style="text-align: left;">1 (0.99,1)</td>
<td style="text-align: left;">0.294</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">0.97 (0.81,1.17)</td>
<td style="text-align: left;">0.758</td>
<td style="text-align: left;">0.93 (0.77,1.12)</td>
<td style="text-align: left;">0.454</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="콕스-생존분석cox-proportional-hazard5점" class="level3">
<h3 class="anchored" data-anchor-id="콕스-생존분석cox-proportional-hazard5점">2-3. 콕스 생존분석(Cox proportional hazard)(5점)</h3>
<ul>
<li>Surv(time, status) ~ rx + age + sex 실행 후 table로 나태내어라.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>res.cox <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> rx <span class="sc">+</span> age <span class="sc">+</span> sex, <span class="at">data =</span> colon, <span class="at">model =</span> T)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>tb.cox <span class="ot">&lt;-</span> <span class="fu">cox2.display</span>(res.cox)   <span class="co"># 'jstable 패키지의 cox2.display' 이용</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tb.cox<span class="sc">$</span>table, <span class="at">caption =</span> tb.cox<span class="sc">$</span>caption)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Cox model on time (‘time’) to event (‘status’)</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 22%">
<col style="width: 18%">
<col style="width: 22%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">crude HR(95%CI)</th>
<th style="text-align: left;">crude P value</th>
<th style="text-align: left;">adj. HR(95%CI)</th>
<th style="text-align: left;">adj. P value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rx: ref.=Obs</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lev</td>
<td style="text-align: left;">0.98 (0.84,1.14)</td>
<td style="text-align: left;">0.786</td>
<td style="text-align: left;">0.98 (0.84,1.14)</td>
<td style="text-align: left;">0.811</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lev+5FU</td>
<td style="text-align: left;">0.64 (0.55,0.76)</td>
<td style="text-align: left;">&lt; 0.001</td>
<td style="text-align: left;">0.64 (0.55,0.76)</td>
<td style="text-align: left;">&lt; 0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">1 (0.99,1)</td>
<td style="text-align: left;">0.382</td>
<td style="text-align: left;">1 (0.99,1)</td>
<td style="text-align: left;">0.468</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">0.97 (0.85,1.1)</td>
<td style="text-align: left;">0.61</td>
<td style="text-align: left;">0.95 (0.84,1.08)</td>
<td style="text-align: left;">0.446</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-3개를-rmarkdown으로-제출하시오." class="level3">
<h3 class="anchored" data-anchor-id="table-3개를-rmarkdown으로-제출하시오.">=&gt; 2-1, 2-2, 2-3 table 3개를 Rmarkdown으로 제출하시오.</h3>
</section>
</section>
<section id="q3.-샤이니-웹-앱-만든-후-shinyapps.io-배포하기10점" class="level2">
<h2 class="anchored" data-anchor-id="q3.-샤이니-웹-앱-만든-후-shinyapps.io-배포하기10점">Q3. 샤이니 웹 앱 만든 후 ShinyApps.io 배포하기(10점)</h2>
<ul>
<li>지난 주 강의 때 실습한 NBA 2018/19 시즌 스탯 혹은 직접 제작한 샤이니 웹 앱 제작하기</li>
<li>ShinyApps.io를 통해 배포한 후, 생성된 url도 함께 제출하시오.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 참고용 예시 코드</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>players <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/nba2018.csv"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"NBA 2018/19 Player Stats"</span>),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Exploring all player stats from the NBA 2018/19 season"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">h3</span>(<span class="st">"Filters"</span>),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sliderInput</span>(</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"VORP"</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Player VORP rating at least"</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">min =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">max =</span> <span class="dv">10</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="dv">0</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Team"</span>, <span class="st">"Team"</span>,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unique</span>(players<span class="sc">$</span>Team),</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="st">"Golden State Warriors"</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strong</span>(</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"There are"</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">textOutput</span>(<span class="st">"num_players"</span>, <span class="at">inline =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">"players in the dataset"</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"nba_plot"</span>),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">DTOutput</span>(<span class="st">"players_data"</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>players_data <span class="ot">&lt;-</span> <span class="fu">renderDT</span>({</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> players <span class="sc">%&gt;%</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(VORP <span class="sc">&gt;=</span> input<span class="sc">$</span>VORP,</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>             Team <span class="sc">%in%</span> input<span class="sc">$</span>Team)</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    data</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>num_players <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> players <span class="sc">%&gt;%</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(VORP <span class="sc">&gt;=</span> input<span class="sc">$</span>VORP,</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>             Team <span class="sc">%in%</span> input<span class="sc">$</span>Team)</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(data)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nba_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> players <span class="sc">%&gt;%</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(VORP <span class="sc">&gt;=</span> input<span class="sc">$</span>VORP,</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>             Team <span class="sc">%in%</span> input<span class="sc">$</span>Team)</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(Salary)) <span class="sc">+</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>()</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>반드시 모든 문제의 ’R 코드’와 ’실행결과(Table, Rmarkdown, url)’를 보내주세요.</p></li>
<li><p>시험/수업 관련 질문은 조교 메일(lisalee1208@naver.com)로 보내 주시면 감사하겠습니다.</p></li>
<li><p>한 학기 동안 수고 많으셨습니다 :)</p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>